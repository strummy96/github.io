<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
     <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>

     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
     <script src="inat.js"></script>
  
  	<script>
      var image_index = 0

      var show_coords = function() {
        let center = map.getCenter()
        let zoom = map.getZoom()
        let center_text = document.getElementById("center")
        let zoom_text = document.getElementById("zoom")
        center_text.textContent = "Center: " + center
        zoom_text.textContent = "Zoom: " + zoom
          }

      var loadFile = function(event) {
        var image_elem = document.getElementById('output');
        var images = event.target.files
        image_elem.src = URL.createObjectURL(images[image_index]);
        document.getElementById("current_photo").textContent = "Current photo: " + images[0].textContent
      };
      
      var next_image = function(event) {
        var images = document.getElementById('file').files
        var image_elem = document.getElementById('output');
        console.log(images)
        console.log(images.length)
        if (image_index < images.length - 1) {
        image_elem.src = URL.createObjectURL(images[image_index += 1])
        }
        console.log("image_index", image_index)
      }

      var previous_image = function(event) {
        var images = document.getElementById('file').files
        var image_elem = document.getElementById('output');
        if (image_index > -1) {
        image_elem.src = URL.createObjectURL(images[image_index -= 1])
        console.log("image index changed")
      }
        else {}
        console.log("image_index", image_index)
      }
  	</script>

    <link rel="stylesheet", type="text/css", href="./style.css"></link>

    <h1>GeoTag your iNaturalist photos</h1>

</head>
<body>
  <div class="container">
 
  	<div class="map-container">
     <div id="map", style="width: 95%; height: 95%"></div>
  	 	<script>
          	const RI_coords = [41.4, -71.5];
            const Sac_coords = [38.925229, -121.393433];
            var map = L.map('map').setView(RI_coords, 10);
          
          	L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    			    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
				      }).addTo(map);

            var center_point = L.circleMarker(map.getCenter(), {
              radius: 10,
              color: 'blue'
            }).addTo(map);

            map.on('move', function(e){
              center_point.setLatLng(map.getCenter());
              map._renderer._update();
            })
       </script>
  		<button onclick=show_coords()>Get center coordinates</button>
      	<p id="center">Center:</p>
      	<p id="zoom">Zoom:</p>
    </div>

    <div class="image-container">
      <div style="padding-top: 20px; padding-bottom: 20px;">
        <input type="checkbox" id="auto-switch" checked="TRUE">
        <label for="auto-switch">Automatically move to next photo</label>
        <script>document.getElementById('auto-switch').checked = true</script>
        </div>

      <div class="image-display">
        <label>Choose an image:</label><br>
      	<input type="file" 
            multiple 
            accept="image/jpeg, image/png" 
            name="image" 
            onchange="loadFile(event)" 
            id="file"><br/>
        <p id="current_photo">Current photo:</p><br/>
        
        <div style="width: 95%; height: 80%">
          <img id="output" width="95%"><br/>
          </div>
        <button onclick=previous_image(event)>Previous image</button>
        <button onclick=next_image(event)>Next image</button>
        </div>
      </div>
    </div>
</body>
</html>






